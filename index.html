<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MaiorMargem - Monitoramento de Preços</title>
<style>
  :root { color-scheme: dark; }
  /* Base */
  html,body{margin:0;height:100%;background:#0b0b0b;color:#fff;font-family:'Segoe UI',Arial,sans-serif}
  a{color:#9cf;text-decoration:none}
  img{display:block;max-width:100%;height:auto}
  /* Header */
  header{display:flex;justify-content:space-between;align-items:center;padding:15px 30px;background:rgba(18,18,18,.95);position:sticky;top:0;z-index:1000;border-bottom:1px solid #222;backdrop-filter:saturate(120%) blur(6px)}
  header img{height:45px}
  .header-buttons button{background:#00b140;color:#fff;border:none;padding:10px 20px;margin-left:10px;border-radius:25px;cursor:pointer;font-size:14px;transition:transform .2s, background .3s}
  .header-buttons button:hover{background:#009b38;transform:scale(1.05)}
  .auth-chip{display:none;background:#0e4;color:#001;padding:6px 10px;border-radius:999px;font-size:12px;margin-left:12px}
  /* Title (above banner) */
  .page-title{max-width:1100px;margin:28px auto 8px;padding:0 20px}
  .page-title h1{margin:0 0 6px;font-size:34px;color:#00b140}
  .page-title p{margin:0;color:#ddd}
  /* HERO: big banner that shrinks */
  .hero-wrap{position:relative;height:70vh;min-height:420px;margin:10px auto 0;max-width:1400px}
  .hero-banner{position:sticky;top:74px;height:calc(70vh - 74px);display:flex;align-items:center;justify-content:center;pointer-events:none;z-index:2}
  .hero-img{width:100%;max-width:1300px;border-radius:14px;box-shadow:0 20px 60px rgba(0,0,0,.6);border:1px solid #242424;will-change:transform,opacity}
  .hero-gradient{position:absolute;inset:0;background:linear-gradient(180deg, rgba(0,0,0,.85) 0%, rgba(0,0,0,0) 40%, rgba(0,0,0,0) 70%, rgba(0,0,0,.9) 100%);z-index:1;pointer-events:none}
  /* Dock area where the banner lands */
  .dock-area{max-width:1200px;margin:0 auto;padding:10px 20px}
  .dock-card{border:1px solid #2a2a2a;background:#121212;border-radius:14px;padding:12px;box-shadow:0 10px 36px rgba(0,0,0,.45)}
  .dock-card img{border-radius:10px}
  /* Gallery aside the dock to avoid overlap */
  .gallery{max-width:1200px;margin:20px auto 30px;padding:0 20px;display:grid;grid-template-columns:repeat(12,1fr);gap:16px}
  .g-item{grid-column:span 12;border:1px solid #2a2a2a;background:#121212;border-radius:14px;overflow:hidden;box-shadow:0 6px 28px rgba(0,0,0,.35)}
  @media(min-width: 900px){ .g-item--half{grid-column:span 6} }
  /* Plans */
  .plans{display:flex;flex-wrap:wrap;justify-content:center;padding:40px 20px;gap:20px;background:#121212}
  .plan{border:1px solid #2a2a2a;border-radius:10px;padding:25px;width:260px;background:#1c1c1c;box-shadow:0 2px 12px rgba(0,0,0,.3);text-align:center;transition:transform .3s, border-color .3s}
  .plan:hover{transform:translateY(-5px);border-color:#00b140}
  .plan h2{color:#00b140;font-size:20px;margin:0}
  .plan ul{list-style:none;padding:0;margin:15px 0;text-align:left}
  .plan ul li{margin-bottom:8px}
  .plan .price{font-size:20px;color:#e63946;font-weight:bold;margin-top:10px}
  /* Panels */
  .overlay{display:none;position:fixed;z-index:1500;inset:0;background:rgba(0,0,0,.5)}
  .side-panel{position:fixed;top:0;right:-400px;width:350px;height:100%;background:#1c1c1c;box-shadow:-4px 0 15px rgba(0,0,0,.5);z-index:2000;padding:20px;transition:right .4s ease;overflow-y:auto}
  .side-panel.active{right:0}
  .side-panel h3{color:#00b140;margin-top:0}
  .side-panel input{width:100%;padding:10px;margin:8px 0;border:1px solid #2a2a2a;border-radius:4px;background:#121212;color:#fff}
  .side-panel button{width:100%;background:#00b140;color:#fff;padding:10px;border:none;border-radius:4px;cursor:pointer}
  .side-panel button:hover{background:#009b38}
  /* Floating clone styles */
  .floating{position:fixed;left:0;top:0;will-change:transform,width,height;z-index:999;pointer-events:none;border-radius:14px;box-shadow:0 20px 60px rgba(0,0,0,.6);border:1px solid #242424}
  .hidden{opacity:0;pointer-events:none}
</style>
</head>
<body>
<header>
  <img src="https://via.placeholder.com/180x45?text=MaiorMargem" alt="MaiorMargem">
  <div style="display:flex; align-items:center;">
    <span id="authChip" class="auth-chip"></span>
    <div id="headerBtns" class="header-buttons">
      <button onclick="openPanel('cadastro')">Cadastrar</button>
      <button onclick="openPanel('login')">Entrar</button>
    </div>
    <div id="goDashboard" class="header-buttons" style="display:none;">
      <button onclick="goDashboard()">Ir para o Dashboard</button>
    </div>
    <div id="logoutBox" class="header-buttons" style="display:none;">
      <button onclick="sair()">Sair</button>
    </div>
  </div>
</header>

<div class="page-title">
  <h1>Monitoramento Inteligente de Preços</h1>
  <p>Visualize tendências, acompanhe concorrentes e tome decisões com dados em tempo real.</p>
</div>

<!-- HERO large banner -->
<div class="hero-wrap">
  <div class="hero-banner" id="heroBanner">
    <img class="hero-img" id="heroImg" src="./Gemini_Generated_Image_ag5zswag5zswag5z.png" alt="Telas principais do sistema de preços">
  </div>
  <div class="hero-gradient"></div>
</div>

<!-- D O C K   A R E A  (local alvo do banner após a rolagem) -->
<div class="dock-area">
  <div class="dock-card">
    <img id="bannerDock" src="./Gemini_Generated_Image_ag5zswag5zswag5z.png" alt="Banner reduzido" class="hidden">
  </div>
</div>

<!-- Outras imagens laterais (não sobrepostas) -->
<div class="gallery" aria-label="Prévias do sistema">
  <div class="g-item g-item--half"><img src="./profiles.JPG" alt="Tela de perfis e preferências"></div>
  <div class="g-item g-item--half"><img src="./tabelas.JPG" alt="Tabelas e relatórios de preços"></div>
</div>

<section class="plans">
  <div class="plan">
    <h2>Trial</h2>
    <ul><li>Monitorar 100 SKUs</li><li>Sites monitorados: 2</li><li>Análise mensal: 1 inclusa</li></ul>
    <div class="price">Gratuito</div>
  </div>
  <div class="plan">
    <h2>Básico</h2>
    <ul><li>Monitorar 1.000 SKUs</li><li>Sites monitorados: 5</li><li>Análise semanal: 4 inclusas</li></ul>
    <div class="price">R$ 129,90</div>
  </div>
  <div class="plan">
    <h2>Intermediário</h2>
    <ul><li>Monitorar 5.000 SKUs</li><li>Sites monitorados: 8</li><li>Análise semanal: 4 inclusas</li></ul>
    <div class="price">R$ 159,90</div>
  </div>
  <div class="plan">
    <h2>Prime</h2>
    <ul><li>Monitorar 20.000 SKUs</li><li>Sites monitorados: 12</li><li>Análise semanal: 4 inclusas</li></ul>
    <div class="price">R$ 249,90</div>
  </div>
</section>

<!-- Overlay -->
<div id="overlay" class="overlay" onclick="closePanel()"></div>

<!-- Painéis -->
<div id="panel-cadastro" class="side-panel" role="dialog" aria-labelledby="cadTitle" aria-modal="true">
  <h3 id="cadTitle">Cadastre-se</h3>
  <input id="nomeCadastro" type="text" placeholder="Nome (opcional)">
  <input id="emailCadastro" type="email" placeholder="Email">
  <input id="senhaCadastro" type="password" placeholder="Senha">
  <button id="btnCadastrar" onclick="registrarUsuario()">Cadastrar</button>
</div>

<div id="panel-login" class="side-panel" role="dialog" aria-labelledby="logTitle" aria-modal="true">
  <h3 id="logTitle">Entrar</h3>
  <input id="emailLogin" type="email" placeholder="Email">
  <input id="senhaLogin" type="password" placeholder="Senha">
  <button onclick="fazerLogin()">Login</button>
  <div style="margin-top:10px; text-align:center;">
    <a href="javascript:void(0)" onclick="openPanel('recuperar')" style="color:#9cf;">Esqueci minha senha</a>
  </div>
</div>

<div id="panel-recuperar" class="side-panel" role="dialog" aria-labelledby="recTitle" aria-modal="true">
  <h3 id="recTitle">Recuperar Senha</h3>
  <input id="emailRecuperar" type="email" placeholder="Digite seu email">
  <button onclick="recuperarSenha()">Enviar link</button>
</div>

<script src="config.js?v=11"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
  function getBaseSite() {
    try { if (window.CONFIG?.SITE_URL) return window.CONFIG.SITE_URL.replace(/\\/+$/,''); }
    catch(_) {}
    return window.location.origin;
  }
  const DASHBOARD_URL = getBaseSite() + '/dashboard.html';

  const { SUPABASE_URL, SUPABASE_ANON_KEY } = window.CONFIG || {};
  const sb = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY, { auth: { persistSession: true, autoRefreshToken: true } });

  function openPanel(type){ document.getElementById('overlay').style.display='block'; const el=document.getElementById('panel-'+type); if(el) el.classList.add('active'); }
  function closePanel(){ document.getElementById('overlay').style.display='none'; document.querySelectorAll('.side-panel').forEach(p=>p.classList.remove('active')); }
  async function registrarUsuario(){ const email=document.getElementById('emailCadastro').value.trim(); const senha=document.getElementById('senhaCadastro').value; const nome=document.getElementById('nomeCadastro').value.trim(); if(!email||!senha)return alert('Preencha email e senha.'); const {error}=await sb.auth.signUp({email,password:senha,options:{data:{nome},emailRedirectTo:getBaseSite()+'/reset.html'}}); if(error)alert('Erro: '+error.message); else alert('Verifique seu email.'); closePanel(); }
  async function fazerLogin(){ const email=document.getElementById('emailLogin').value.trim(); const senha=document.getElementById('senhaLogin').value; const {error}=await sb.auth.signInWithPassword({email,password:senha}); if(error)return alert('Erro: '+error.message); window.location.assign(DASHBOARD_URL); }
  async function sair(){ await sb.auth.signOut(); alert('Você saiu.'); }
  async function recuperarSenha(){ const email=document.getElementById('emailRecuperar').value.trim(); const {error}=await sb.auth.resetPasswordForEmail(email,{redirectTo:getBaseSite()+'/reset.html'}); if(error)alert('Erro: '+error.message); else alert('Link enviado.'); closePanel(); }

  // ===== Scroll shrink & dock =====
  (function(){
    const hero = document.getElementById('heroBanner');
    const heroImg = document.getElementById('heroImg');
    const dockImg = document.getElementById('bannerDock');
    let docked = false;
    let animating = false;

    function getRects(){
      const h = heroImg.getBoundingClientRect();
      const d = dockImg.getBoundingClientRect();
      return {h,d};
    }

    function createClone(rect){
      const clone = heroImg.cloneNode(true);
      clone.removeAttribute('id');
      clone.classList.add('floating');
      clone.style.width = rect.width + 'px';
      clone.style.height = rect.height + 'px';
      clone.style.left = rect.left + 'px';
      clone.style.top = rect.top + 'px';
      clone.style.transform = 'translate(0,0)';
      document.body.appendChild(clone);
      return clone;
    }

    function dock(){
      if (docked || animating) return;
      animating = true;
      const {h,d} = getRects();
      const clone = createClone(h);
      heroImg.classList.add('hidden');
      dockImg.classList.add('hidden');

      const dx = (d.left - h.left);
      const dy = (d.top - h.top);
      const sx = d.width / h.width;
      const sy = d.height / h.height;

      requestAnimationFrame(()=>{
        clone.style.transition = 'transform 400ms ease, width 400ms ease, height 400ms ease, left 400ms ease, top 400ms ease';
        clone.style.left = h.left + 'px';
        clone.style.top = h.top + 'px';
        clone.style.transformOrigin = 'top left';
        clone.style.transform = `translate(${dx}px, ${dy}px) scale(${sx}, ${sy})`;
      });

      setTimeout(()=>{
        clone.remove();
        dockImg.classList.remove('hidden');
        docked = true; animating = false;
      }, 420);
    }

    function undock(){
      if (!docked || animating) return;
      animating = true;
      const {h,d} = getRects();
      const clone = createClone(d);
      dockImg.classList.add('hidden');

      const dx = (h.left - d.left);
      const dy = (h.top - d.top);
      const sx = h.width / d.width;
      const sy = h.height / d.height;

      requestAnimationFrame(()=>{
        clone.style.transition = 'transform 400ms ease';
        clone.style.transformOrigin = 'top left';
        clone.style.transform = `translate(${dx}px, ${dy}px) scale(${sx}, ${sy})`;
      });

      setTimeout(()=>{
        clone.remove();
        heroImg.classList.remove('hidden');
        docked = false; animating = false;
      }, 420);
    }

    function onScroll(){
      // Shrink effect while scrolling towards the dock
      const dockTop = document.querySelector('.dock-area').getBoundingClientRect().top + window.scrollY;
      const start = hero.offsetTop;
      const end = dockTop - 160; // point to start docking
      const y = window.scrollY;
      const progress = Math.min(1, Math.max(0, (y - start) / (end - start)));
      const scale = 1 - (0.35 * progress); // shrink to ~65%
      heroImg.style.transform = `scale(${scale})`;

      if (y >= end) dock();
      else undock();
    }

    window.addEventListener('scroll', onScroll, {passive:true});
    window.addEventListener('resize', ()=>{ if(docked){ undock(); dock(); } });
  })();
</script>
</body>
</html>
